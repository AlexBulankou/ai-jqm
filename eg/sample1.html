<!DOCTYPE html>
<html>

<head>
    <title>JQM with AppInsights Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
    <style type="text/css">
        #stock-price {
            font-size: 4em;
        }
    </style>
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://cdn.rawgit.com/azicchetti/jquerymobile-router/v0.93/js/jquery.mobile.router.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    <!-- https://github.com/azicchetti/jquerymobile-router -->

    <script type="text/javascript">
        window.router=new $.mobile.Router({   
              "#stock([?](\.+))?": { handler: function(type,args){
                  var stockSymbol = args[2].toUpperCase();
                   $("#stock-h1").html(stockSymbol);
                  $.ajax(
                    { 
                        url:"http://finance.google.com/finance/info?client=ig&q="+stockSymbol, 
                        jsonp:"callback", 
                        dataType:"jsonp", 
                        success:function(data){
                        $("#stock-price").html(data[0].l_cur); 
                    } 
                    });
                    
                    console.log(stockSymbol);
           
          }, events: "bs" }    
        }
        );
        
        $.mobile.urlHistory = {};
    </script
</head>

<body>
    <!-- Home page -->
    <div data-role="page" id="home">
        <div data-role="header">
      
            <h1>JQM with AppInsights Demo</h1>

        </div> 
        <!-- /header -->
        <div role="main" class="ui-content">
           
                <ul data-role="listview">
                    <li><a href="#stock?aapl">AAPL</a></li>
                    <li><a href="#stock?amzn">AMZN</a></li>
                    <li><a href="#stock?goog">GOOG</a></li>
                    <li><a href="#stock?fb">FB</a></li>
                    <li><a href="#stock?msft">MSFT</a></li>
                </ul>
           
          
            <div class="ui-body">
                <p>
                    <a href="#dlg" class="ui-shadow ui-btn ui-corner-all ui-btn-inline" data-transition="flip">Open dialog</a>
                </p>
            </div>
        </div>
        <!-- /content -->
    </div>
    <!-- /page -->


    <div data-role="page" id="stock">
        <div data-role="header" data-add-back-btn="true">
        
            <h1 id="stock-h1">...</h1>
        </div>
        <!-- /header -->
        <div role="main" class="ui-content">
           <div id="stock-price"></div>
        </div>
        <!-- /content -->
    </div>


    <div data-role="page" id="dlg">
        <div data-role="header">
            <h1>...</h1>
        </div>
        <!-- /header -->
        <div role="main" class="ui-content">
            <p><a href="#home">Back home</a></p>
        </div>
        <!-- /content -->
    </div>

</body>

</html>